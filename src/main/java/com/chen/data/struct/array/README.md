# 数组

![数组](https://img-blog.csdnimg.cn/20201013113132628.png)

数组是在程序设计中，为了处理方便， 把具有相同类型的若干元素按有序的形式组织起来的一种形式。

数组会利用 索引 来记录每个元素在数组中的位置，且在大多数编程语言中，索引是从 0 算起的。我们可以根据数组中的索引，快速访问数组中的元素。事实上，这里的索引其实就是内存地址。

作为线性表的实现方式之一，数组中的元素在内存中是 连续 存储的，且每个元素占用相同大小的内存。

数组是非常常用的线性数据结构，其核心是：把元素码成一排进行存放，利用索引访问。

数组最大的优点：能够快速查询，通过索引查询，时间复杂度为：O(1)。

数组存放元素的数量，即数组的长度，在声明数组时便需要确定好，且数组长度不可变，称为定长数组，高级编程语言一般都提供了该数据类型；

后面部分主要介绍：
- 动态数组实现的原理
- 时间复杂度分析
- 实践编写动态数组类

## 原理

**定义：**
- size : 动态数组已存储元素的数量
- data : 动态数组类中用于存储元素的数组
- data.length : 动态数组类中用于存储元素的数组的容量

**数组容量动态扩容：**
- 当添加一个新的元素时，数组已存储元素数量与数组容量相等时，对数组进行扩容操作；
  - if(size == data.length) { resize(2*data.length); }
- 扩容操作：创建一个现有数组容量2倍的新数组，并将原数组中所有元素复制到新数组中；
- 再执行数组元素添加；

**数组容量动态缩容：**
- 当删除一个数组中的元素后，数组已存储元素数量是数组容量的1/4，将数组容量缩容为原容量的1/2且不等于0（预留空间，避免因元素增删造成数组频繁扩缩容），对数组进行缩容操作；
  - if(size == data.length/4 && data.length/2 !=0) { resize(data.length/2); }
- 缩容操作：创建一个现有数组容量1/2的新数组，并将原数组中所有元素复制到新数组中；

**向数组末尾添加元素：**
- 检查数组空间是否已满，如果已满进行扩容操作；
- 直接在数组末尾添加元素；

**向数组头部/指定索引位置添加元素：**
- 检查数组空间是否已满，如果已满进行扩容操作；
- 将数组中从末尾到头部/指定索引位置元素全部往后移动一个位置；
- 将新的元素添加到数组头部/指定索引位置；

**删除数组头部/指定索引位置元素：**
- 将数组末尾到头部/指定索引位置的后一个位置所有元素往前移动一个位置；
- 检查数组空间容量是否需要进行缩容。

## 时间复杂度分析

常见算法时间复杂度有：O(1),O(n),O(logn),O(nlogn),O(n^2)

大O描述的是算法的运行时间和输入数据之间的关系。忽略常数、不要低价项，只要高阶项；再根据具体数据样本分析；

在动态数组中，添加和删除操作都有可能触发resize()操作，通过均摊复杂度分析综合分析来确定。

动态数组通过resize()操作，在删除或新增操作时，根据现有数组中元素数量来自动调节数组容量大小(capacity)；

添加操作  O(n)
- addLast(e)   O(1)
- addFirst(e)  O(n)
- add(index,e) O(n/2) = O(n)
- resize()     O(n)

删除操作  O(n)
- removeLast()   O(1)
- removeFirst()  O(n)
- remove(index)  O(n/2) = O(n)
- resize()  O(n)

修改操作  O(1)
- set(index,e)  O(1)

查找操作  O(1) / O(n)
- get(index)  O(1)
- contains(e)  O(n)
- find(e)  O(n)

执行reszie()操作要防止复杂度震荡问题，如：
- 当数组容量满后，添加一个元素后，会使用resize()进行扩容(时间复杂度为O(n))，
- 之后又删除一个元素，若又立即执行resize()进行缩容(时间复杂度为0(n))，
- 如此反复，会让数组的增加和删除操作时间复杂度都为O(n) ；
- 解决方法：Lazy，当数组中元素数量 size==capacity/4 时，才将capacity减半，容量减半需要注意容量不能减为0；

## 实践

### 封装类方法分析

封装数组类：
1. 判断是否为空  public boolean isEmpty()
2. 获取数组中元素个数  public int getSize()
3. 获取当前数组容量  public int getCapacity()

添加元素：
1. 在指定索引位置添加元素  public void add(int index, E e)
2. 在头部添加元素  public void addLast(E e)
3. 在尾部添加元素  public void addFirst(E e)

查询元素：
1. 获取索引位置元素  public E get(int index)
2. 根据指定元素查找索引  public int find(E e)
3. 查找数组中是否包含指定元素  public boolean contains(E e)

修改和删除元素：
1. 修改指定索引位置元素  public void set(int index, E e)
2. 删除指定索引位置元素  public E remove(int index)
3. 删除第一个元素  public E removeFirst()
4. 删除最后一个元素  public E removeLast()
5. 删除指定元素  public void removeElement(E e)

数组扩展：
1. 对数组中元素支持泛型
2. 扩缩容操作  private void resize(int newCapacity)

### code

[DynamicArray.java](./DynamicArray.java)


## 参考

Leetcode

刘宇波《玩转数据结构》课程